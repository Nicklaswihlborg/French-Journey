<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>French Journey â€” B2 Journey</title>
  <meta name="description" content="Multi-section French learning app with goals, tracking, speaking, listening, comprehension, vocabulary, and daily phrases." />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="wrap">
    <header class="header">
      <div class="app-title">
        <h1>ğŸ‡«ğŸ‡· French Journey â€” B2 Journey</h1>
      </div>
      <div class="row small">
        <span id="streakBadge" class="badge">ğŸ”¥ Streak: 0</span>
        <span id="goalBadge" class="badge">ğŸ¯ Objectif: 30 xp/jour</span>
        <span id="b2Badge" class="badge">ğŸ“ Objectif B2: <span id="daysToB2"></span> jours</span>
      </div>
    </header>

    <nav id="tabs"></nav>

    <!-- DASHBOARD -->
    <section id="view-dashboard" class="view">
      <div class="grid">
        <div class="col-6">
          <div class="card">
            <div class="section-title"><h2>ğŸ“ˆ Progression du jour</h2><span class="chip small">se rÃ©initialise chaque jour</span></div>
            <div class="row small">
              <span>Objectif:</span><span id="goalVal" class="k mono">30 xp</span>
              <button class="btn" id="decGoal">-</button>
              <button class="btn" id="incGoal">+</button>
              <span>GagnÃ©:</span><span id="xpVal" class="k mono">0</span>
            </div>
            <div class="bar" style="margin-top:8px"><span id="xpBar" style="width:0%"></span></div>
            <div class="row" style="margin-top:10px">
              <button class="btn" data-xp="5" data-flag="listening">+5 Ã‰coute</button>
              <button class="btn" data-xp="5" data-flag="speaking">+5 Parler</button>
              <button class="btn" data-xp="5" data-flag="reading">+5 Lecture</button>
              <button class="btn" data-xp="5" data-flag="vocab">+5 Vocabulaire</button>
              <button class="btn" data-xp="5" data-flag="phrases">+5 Phrases</button>
              <button class="btn warn" id="resetDay">RÃ©initialiser</button>
            </div>
            <p class="muted small">Conseil : visez 30â€“45 xp/jour. 5 xp â‰ˆ 5â€“10 minutes dâ€™effort concentrÃ©.</p>
          </div>
        </div>

        <div class="col-6">
          <div class="card">
            <div class="section-title"><h2>ğŸ“Š 14 derniers jours</h2><span class="chip small">tendance & cumul</span></div>
            <canvas id="chart14"></canvas>
            <div class="row small" style="margin-top:8px">
              <span>Total 14j: <span id="sum14" class="mono">0</span> xp</span>
              <span>Semaine en cours: <span id="wkXp" class="mono">0</span> xp</span>
              <span>Streak jours â‰¥ objectif: <span id="streakDays" class="mono">0</span></span>
            </div>
          </div>
        </div>

        <div class="col-4">
          <div class="card">
            <div class="section-title"><h2>ğŸ¯ Objectifs</h2></div>
            <div class="row small">
              <label for="dailyMinutes" class="muted">Minutes/jour:</label>
              <input id="dailyMinutes" type="number" min="5" step="5" />
              <button class="btn" id="saveDailyMinutes">Sauver</button>
            </div>
            <div class="row small" style="margin-top:6px">
              <label for="weeklyHours" class="muted">Heures/semaine:</label>
              <input id="weeklyHours" type="number" min="1" step="1" />
              <button class="btn" id="saveWeeklyHours">Sauver</button>
            </div>
            <hr />
            <p class="small">RecommandÃ© pour passer A2 â†’ B2 dâ€™ici fin dâ€™annÃ©e : <strong>7â€“10 h / semaine</strong> + pratique active quotidienne (parler/Ã©couter).</p>
            <p class="muted small">Aujourdâ€™hui: <span id="todayPlan"></span></p>
          </div>
        </div>

        <div class="col-4">
          <div class="card">
            <div class="section-title"><h2>ğŸ§± Plan B2</h2></div>
            <ul class="list small">
              <li><strong>Quotidien (30â€“45 min):</strong> 10 min vocab SRS, 10 min comprÃ©hension, 10â€“15 min parler/Ã©couter.</li>
              <li><strong>Hebdo (1â€“2Ã—):</strong> 30â€“45 min conversation rÃ©elle (tuteur ou tandem).</li>
              <li><strong>Mensuel:</strong> mini test DELF B1/B2 (lecture, Ã©coute, production).</li>
              <li><strong>QualitÃ© > quantitÃ©:</strong> feedback, correction active, rÃ©vision espacÃ©e.</li>
            </ul>
          </div>
        </div>

        <div class="col-4">
          <div class="card">
            <div class="section-title"><h2>ğŸ› ï¸ DonnÃ©es</h2></div>
            <div class="row">
              <button class="btn" id="exportData">Exporter</button>
              <label class="btn">
                Importer <input id="importData" type="file" accept="application/json" class="hidden" />
              </label>
              <button class="btn bad" id="factoryReset">RÃ©initialisation complÃ¨te</button>
            </div>
            <p class="small muted">Tout est stockÃ© <em>localement</em> (localStorage). Lâ€™export crÃ©e un fichier .json Ã  conserver.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- COMPRÃ‰HENSION -->
    <section id="view-comprehension" class="view hidden">
      <div class="card">
        <div class="section-title"><h2>ğŸ“° ComprÃ©hension (actualitÃ©s simplifiÃ©es)</h2><span class="chip small">FR â‡„ EN + questions</span></div>
        <div class="row">
          <button class="btn" id="nextArticle">Nouveau texte</button>
          <button class="btn" id="toggleArticleLang">Afficher traduction (EN)</button>
          <button class="btn" id="speakArticle">ğŸ”Š Ã‰couter</button>
          <button class="btn" id="stopSpeakArticle">â¸ï¸ Stop</button>
          <button class="btn ok" id="markCompXP">+5 xp</button>
        </div>
        <textarea id="articleBox"></textarea>
        <div id="articleQA" class="small" style="margin-top:8px"></div>
        <p class="muted small">Astuce: Ã©coutez dâ€™abord, puis lisez, puis rÃ©pondez mentalement aux questions avant de rÃ©vÃ©ler.</p>
      </div>
    </section>

    <!-- PARLER -->
    <section id="view-speaking" class="view hidden">
      <div class="card">
        <div class="section-title"><h2>ğŸ¤ Parler</h2><span class="chip small">Reconnaissance vocale (Chrome) + invites</span></div>
        <div class="row small">
          <span id="micState" class="pill">ğŸ™ï¸ Micro: <span class="mono">checkingâ€¦</span></span>
          <span id="recState" class="pill">ğŸ—£ï¸ Ã‰tat: <span class="mono">inactif</span></span>
        </div>
        <div class="row" style="margin-top:8px">
          <button class="btn" id="askMic">Autoriser micro</button>
          <button class="btn" id="startRec">DÃ©marrer</button>
          <button class="btn bad" id="stopRec" disabled>ArrÃªter</button>
          <button class="btn ok" id="markSpeakXP">+5 xp</button>
        </div>
        <p class="muted small">Choisissez un sujet et parlez 60â€“120 s. Visez des phrases complÃ¨tes et des connecteurs (dâ€™abord, ensuite, pourtantâ€¦).</p>
        <div class="row">
          <select id="promptSelect" class="btn"></select>
          <button class="btn" id="newPrompt">Nouvelle invite</button>
          <button class="btn" id="speakPrompt">ğŸ”Š Lire lâ€™invite</button>
        </div>
        <textarea id="promptBox" class="small" readonly></textarea>
        <textarea id="speechOut" placeholder="Votre transcription apparaÃ®tra iciâ€¦"></textarea>
      </div>
    </section>

    <!-- Ã‰COUTE -->
    <section id="view-listening" class="view hidden">
      <div class="card">
        <div class="section-title"><h2>ğŸ‘‚ Ã‰coute / DictÃ©e</h2><span class="chip small">Taper ce que vous entendez</span></div>
        <div class="row">
          <button class="btn" id="playDictation">â–¶ï¸ Lire</button>
          <button class="btn" id="replayDictation">â†» Relire</button>
          <button class="btn ok" id="markListenXP">+5 xp</button>
        </div>
        <p id="dictationHint" class="muted small"></p>
        <textarea id="dictationInput" placeholder="Ã‰crivez ce que vous entendez iciâ€¦"></textarea>
        <div class="row">
          <button class="btn" id="checkDictation">VÃ©rifier</button>
          <span id="dictationScore" class="score"></span>
        </div>
        <details style="margin-top:8px">
          <summary>Afficher le texte cible</summary>
          <p id="dictationTarget" class="small"></p>
        </details>
      </div>
    </section>

    <!-- VOCAB -->
    <section id="view-vocab" class="view hidden">
      <div class="card">
        <div class="section-title"><h2>ğŸ“š Vocabulaire (rÃ©pÃ©tition espacÃ©e)</h2><span class="chip small">Due aujourdâ€™hui: <span id="dueCount">0</span></span></div>
        <div class="grid">
          <div class="col-6">
            <h3>Ajouter des mots</h3>
            <div class="row">
              <input id="vFr" type="text" placeholder="mot (FR) â€” ex: envisager" />
              <input id="vEn" type="text" placeholder="translation (EN) â€” ex: to consider" />
            </div>
            <div class="row" style="margin-top:6px">
              <button class="btn" id="addWord">Ajouter</button>
              <button class="btn" id="exportVocab">Exporter</button>
              <label class="btn">Importer <input id="importVocab" type="file" accept="application/json" class="hidden"/></label>
              <button class="btn bad" id="clearVocab">Effacer tout</button>
            </div>
            <hr/>
            <table id="vTable">
              <thead><tr><th>FR</th><th>EN</th><th>Prochain</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="col-6">
            <h3>Quiz (FR â†’ EN)</h3>
            <div class="row small">
              <span class="muted">Cartes dues: <span id="dueNow">0</span></span>
              <button class="btn" id="startQuiz">Commencer</button>
              <button class="btn" id="skipCard" disabled>Passer</button>
            </div>
            <div class="card" style="margin-top:8px">
              <div id="quizFront" class="section-title"><h2>â€”</h2></div>
              <input id="quizAnswer" type="text" placeholder="Votre traductionâ€¦" />
              <div class="row" style="margin-top:8px">
                <button class="btn" id="revealA">RÃ©vÃ©ler</button>
                <span id="quizBack" class="k"></span>
              </div>
              <div class="row" style="margin-top:8px">
                <button class="btn bad" id="rateAgain" disabled>Encore (0)</button>
                <button class="btn warn" id="rateHard" disabled>Difficile (2)</button>
                <button class="btn" id="rateGood" disabled>Bien (3)</button>
                <button class="btn ok" id="rateEasy" disabled>Facile (4)</button>
                <button class="btn ok" id="markVocabXP" disabled>+5 xp</button>
              </div>
            </div>
            <p class="muted small">Algorithme SRS simple (type SM-2).</p>
          </div>
        </div>
      </div>
    </section>

    <!-- PHRASES -->
    <section id="view-phrases" class="view hidden">
      <div class="card">
        <div class="section-title"><h2>ğŸ—£ï¸ Phrases courantes â€” entraÃ®nement quotidien</h2><span class="chip small">10 par jour</span></div>
        <div class="row">
          <button class="btn" id="newPhrases">Nouveau set</button>
          <button class="btn" id="speakAllPhrases">ğŸ”Š Ã‰couter tout</button>
          <button class="btn ok" id="markPhrasesXP">+5 xp</button>
        </div>
        <div id="phraseList" class="small" style="margin-top:8px"></div>
      </div>
    </section>

    <p class="small muted footer-note">Conseil: rÃ©partissez la pratique (parler/Ã©couter/lire/vocab) chaque jour; gardez la cadence plutÃ´t que des marathons irrÃ©guliers.</p>
  </div>

  <!-- Use a fresh filename to bust cache -->
  <script src="./app.v5.js" defer></script>
</body>
</html>
